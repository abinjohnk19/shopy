{% extends 'base.html' %}
{% block content %}
<br>

<h2 class="section-title">Your Cart</h2>

<div class="cart-container">

{% if cart_items %}
    {% for item in cart_items %}
    <div class="cart-item">
        <img src="{{ item.product.image.url }}" width="100">

        <div>
            <h3>{{ item.product.name }}</h3>
            <p>₹{{ item.product.price }}</p>

            <form method="post" action="{% url 'update_quantity' item.product.id %}">
    {% csrf_token %}

    <div class="qty-control">
        <button type="button" class="qty-btn minus" onclick="decreaseQty(this)">−</button>

        <input type="number" name="quantity"
               value="{{ item.quantity }}"
               min="1"
               class="qty-input">

        <button type="button" class="qty-btn plus" onclick="increaseQty(this)">+</button>
    </div>

    <button type="submit" class="update-btn">Update</button>
</form>

            <p>Subtotal: ₹{{ item.subtotal }}</p>
            <a href="{% url 'remove_from_cart' item.product.id %}">Remove</a>
        </div>
    </div>
    {% endfor %}

    <h3>Total: ₹{{ total }}</h3>
    <br>

    <a href="{% url 'order' %}" class="btn cart-btn">Proceed to Order</a>

{% else %}
    <p>Your cart is empty.</p>
{% endif %}

</div>
<script>
function increaseQty(btn) {
    const input = btn.parentElement.querySelector('.qty-input');
    input.value = parseInt(input.value) + 1;
}

function decreaseQty(btn) {
    const input = btn.parentElement.querySelector('.qty-input');
    if (parseInt(input.value) > 1) {
        input.value = parseInt(input.value) - 1;
    }
}
</script>

{% endblock %}